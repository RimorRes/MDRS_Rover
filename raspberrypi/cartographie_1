import csv
from .ino import serial as ardu

#X/Y/°C/Pa (pression)/Puissance:Vitesse Du Vent/ Orientation Du Vent/ H (magnétique)
# Données enregistrés dans carthographie/graphe sous le format 0/0/0/0/0/0/0/0
#Chaque / signale qu'on passe à la prochaine donnée enregistré 
#Les données sont enregistré dans 0/0/0/0/0/0/0/0 dans l'ordre décrite à la ligne 4.
#Consigne : ne vas pas marcher avec excel qui a comme délimitation le ";" => le ";" est réservé pour la communication entre rasberry/Arduino

def recevoir_donnees(): #D
    #Fonction qui va recevoir les données collectés par les capteurs, les garder dans data et les envoyer.
    #data : liste/tuple argument , elle va garder les donnees collectes par les capteurs. 
    data = []
    ardu.Run("feed_me;Null;;") #Fonction qui va se trouver, si Antonio le veut, dans leurs code. Cette fonction va aller chercher les resultats des capteurs
    data = ardu.serialPull(1000)[0].rsplit(';')[0] #Supposons que les données vont être envoyés de sorte : ['0/0/0/0/0/0/0/0;null;;']
    return data

def vide_ou_non ():
  ouvrir = open("cartographie.csv",'r')
  for i in ouvrir :
    ouvrir.close()
    return False
  ouvrir.close()
  return True

def ajouter_csv():
    #La fonction va ajouter une liste dans le fichier CSV.
    #typ : str, contient le paramètre que dois utiliser la fonction open()
    
    data = recevoir_donnees()
    if vide_ou_non():
        typ = "w"
    else :
        typ = "a"
        
    o = open('cartographie.csv',typ,newline='')
    m = csv.writer(o, delimiter = ",")
    m.writerow(data)
    o.close()
